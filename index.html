<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üèÅ Enrollment Race to 550</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
body{
  margin:0;
  padding:28px;
  font-family:Arial, sans-serif;
  text-align:center;
  background:
    repeating-linear-gradient(
      90deg,#fff 0,#fff 16px,#000 16px,#000 32px
    ) top center/100% 20px no-repeat,
    linear-gradient(#86efac,#4ade80);
}

/* ================= MVP CARD ================= */
#mvp{
  position:fixed;
  top:18px;
  left:18px;

  background:#fff7ed;
  border:5px solid #f59e0b;
  border-radius:22px;

  padding:20px 26px;
  min-width:220px;

  font-size:16px;
  line-height:1.35;

  box-shadow:
    0 0 22px rgba(245,158,11,.9),
    0 12px 28px rgba(0,0,0,.25);

  animation:pulse 2s infinite;
  z-index:999;
  text-align:left;
}
#mvp strong{
  display:block;
  font-size:20px;
  margin:4px 0;
}

@keyframes pulse{
  0%{box-shadow:0 0 12px rgba(245,158,11,.6);}
  50%{box-shadow:0 0 24px rgba(245,158,11,1);}
  100%{box-shadow:0 0 12px rgba(245,158,11,.6);}
}

/* ================= LAYOUT ================= */
h1{color:#dc2626;margin-bottom:16px;}

.buttons{
  display:flex;justify-content:center;gap:10px;margin-bottom:18px;
}
button{
  padding:10px 18px;border-radius:999px;border:none;
  background:#0f172a;color:white;font-weight:bold;cursor:pointer;
}

/* ================= CARDS ================= */
.card{
  background:white;
  max-width:380px;
  margin:18px auto;
  padding:20px;
  border-radius:24px;
  box-shadow:0 16px 36px rgba(0,0,0,.25);
  border:4px solid transparent;
}

.team{border-color:#dc2626;}
.Leeah{border-color:#facc15;}
.Marissa{border-color:#ec4899;}
.Chakri{border-color:#f97316;}
.Nitya{border-color:#2563eb;}

/* ================= PROGRESS ================= */
.progress{
  background:#e5e7eb;
  height:24px;
  border-radius:999px;
  overflow:hidden;
  position:relative;
  margin:12px 0;
}

.bar{
  height:100%;
  border-radius:999px;
  transition:width .7s ease;
  position:relative;
}

.car{position:absolute;right:-6px;top:-20px;font-size:22px;}
.smoke{position:absolute;right:-26px;top:-10px;font-size:14px;opacity:.7;}

.meta{font-size:14px;opacity:.75;margin-top:4px;}
.good{color:#16a34a;}
.bad{color:#dc2626;}
</style>
</head>

<body>

<div id="mvp">üèÜ Weekly MVP</div>

<h1>üèÅ Enrollment Race to 550</h1>

<div class="buttons">
  <button onclick="setView('ytd')">Year to Date</button>
  <button onclick="setView('month')">This Month</button>
  <button onclick="setView('week')">This Week</button>
</div>

<div id="team"></div>
<div id="dashboard"></div>

<script>
const TEAM_GOAL=550;
const YEARLY_CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTDtYk0GQ5RzrRT_SBmcjH1TfE3k_kHJ5Sd7nmnoKr81UiDPHXF42gd46qCAuAW5hpwjdKC-6-P8bji/pub?gid=1984389436&single=true&output=csv";
const WEEKLY_CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTDtYk0GQ5RzrRT_SBmcjH1TfE3k_kHJ5Sd7nmnoKr81UiDPHXF42gd46qCAuAW5hpwjdKC-6-P8bji/pub?gid=0&single=true&output=csv";
const RACE_END=new Date("2026-12-31");

let view="ytd",weeklyData=[];

const pct=(t,g)=>g?Math.round(t/g*100):0;
const barColor=p=>`linear-gradient(90deg,#facc15,hsl(${60+p},90%,45%))`;

function setView(v){view=v;loadData();}

function loadData(){
Promise.all([
  fetch(YEARLY_CSV_URL).then(r=>r.text()),
  fetch(WEEKLY_CSV_URL).then(r=>r.text())
]).then(([y,w])=>{
weeklyData=w.split("\n").slice(1).map(r=>{
  const c=r.split(",");
  const v=parseInt(c[2],10);
  if(!c[0]||!c[1]||isNaN(v)) return null;
  return{date:new Date(c[0]),name:c[1].trim(),value:v};
}).filter(Boolean);

const people=y.split("\n").slice(1).map(r=>{
  const c=r.split(",");
  const name=c[0]?.trim();
  const goal=parseInt(c[1],10);
  const ytd=parseInt(c[2],10);
  if(!name||isNaN(goal)) return null;
  return{name,goal,ytd:ytd||0,total:0,week:0};
}).filter(Boolean);

const now=new Date();

people.forEach(p=>{
  weeklyData.forEach(r=>{
    if(r.name!==p.name) return;
    const d=(now-r.date)/86400000;
    if(d>=0&&d<=7) p.week+=r.value;
    if(view==="month"&&
      r.date.getMonth()===now.getMonth()&&
      r.date.getFullYear()===now.getFullYear())
      p.total+=r.value;
  });
  if(view==="ytd") p.total=p.ytd;
});

render(people);
});
}

function celebrate(){
confetti({particleCount:150,spread:80,origin:{y:.6}});
}

function render(people){
people.sort((a,b)=>pct(b.total,b.goal)-pct(a.total,a.goal));
const dash=document.getElementById("dashboard");
dash.innerHTML="";

const teamTotal=people.reduce((a,b)=>a+b.total,0);
const teamPct=pct(teamTotal,TEAM_GOAL);
const daysLeft=Math.max(0,Math.ceil((RACE_END-new Date())/86400000));

document.getElementById("team").innerHTML=`
<div class="card team">
<h2>üèÅ Team Goal</h2>
<div class="progress">
<div class="bar" style="width:${teamPct}%;background:${barColor(teamPct)}">
<span class="car">üèéÔ∏è</span><span class="smoke">üí®</span>
</div></div>
<p>${teamTotal} / ${TEAM_GOAL} (${teamPct}%)</p>
<p class="meta">‚è≥ ${daysLeft} days to finish</p>
</div>`;

const mvp=people.reduce((a,b)=>b.week>a.week?b:a,people[0]);
document.getElementById("mvp").innerHTML=
`üèÜ Weekly MVP<br><strong>${mvp.name}</strong><br>üî• ${mvp.week} this week`;

celebrate();

people.forEach((p,i)=>{
const pPct=pct(p.total,p.goal);
const medal=i===0?"ü•á":i===1?"ü•à":i===2?"ü•â":"";
dash.innerHTML+=`
<div class="card ${p.name}">
<h2>${medal} ${p.name}</h2>
<div class="progress">
<div class="bar" style="width:${pPct}%;background:${barColor(pPct)}">
<span class="car">üèéÔ∏è</span><span class="smoke">üí®</span>
</div></div>
<p>${p.total} / ${p.goal} (${pPct}%)</p>
</div>`;
});
}

loadData();
</script>

</body>
</html>
