<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Enrollment Race to 550</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root{
  --bg1:#fecdd3;
  --bg2:#ffe4e6;
  --primary:#e11d48;
  --accent:#fb7185;
}

body{
  margin:0;
  padding:60px 16px 80px;
  font-family:Arial,sans-serif;
  background:repeating-linear-gradient(90deg,var(--bg1) 0 60px,var(--bg2) 60px 120px);
  text-align:center;
}

body::before{
  content:"";
  position:fixed;
  top:0;left:0;width:100%;height:26px;
  background:repeating-linear-gradient(90deg,#000 0 20px,#fff 20px 40px);
}

h1{color:var(--primary);font-size:40px;margin-bottom:12px}

.buttons button{
  margin:6px;padding:10px 18px;border-radius:16px;border:none;
  font-weight:bold;cursor:pointer
}
.buttons button.active{background:var(--accent);color:white}

#topRow{
  display:grid;
  grid-template-columns:260px 1fr 260px;
  gap:16px;
  max-width:1100px;
  margin:20px auto 30px;
  align-items:center;
}

.card{
  background:#fff;padding:20px;border-radius:22px;
  box-shadow:0 10px 26px rgba(0,0,0,.15);
  position:relative
}

.progress{
  background:#e5e7eb;
  height:20px;
  border-radius:14px;
  margin:12px 0;
}
.bar{
  height:100%;
  background:linear-gradient(90deg,#facc15,var(--accent));
  border-radius:14px;
}

#dashboard{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:16px;max-width:1200px;margin:0 auto 30px
}

#mvp{border:4px solid #f59e0b;font-weight:bold}
.mvp-badge{
  position:absolute;top:-12px;right:-12px;
  background:#facc15;padding:6px 10px;border-radius:999px
}

#podium{border:4px solid silver}
.podium-row{display:flex;justify-content:space-between;font-weight:bold}

#managersHeader{font-size:22px;font-weight:bold;color:#1d4ed8;margin-bottom:14px}
#managers{
  display:grid;grid-template-columns:repeat(3,1fr);
  gap:16px;max-width:900px;margin:0 auto
}
</style>
</head>

<body>

<h1>üíñ Enrollment Race to 550 üíñ</h1>

<div class="buttons">
  <button onclick="setView('ytd',this)">Year to Date</button>
  <button class="active" onclick="setView('month',this)">This Month</button>
  <button onclick="setView('week',this)">This Week</button>
</div>

<div id="topRow">
  <div id="mvp" class="card"></div>
  <div id="team"></div>
  <div id="podium" class="card"></div>
</div>

<div id="dashboard"></div>
<div id="managersHeader">‚≠ê Managers</div>
<div id="managers"></div>

<script>
/* üî¥ PASTE YOUR GOOGLE SHEET CSV LINK HERE */
const YEARLY_CSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vTDtYk0GQ5RzrRT_SBmcjH1TfE3k_kHJ5Sd7nmnoKr81UiDPHXF42gd46qCAuAW5hpwjdKC-6-P8bji/pub?gid=1984389436&single=true&output=csv";
const WEEKLY_CSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vTDtYk0GQ5RzrRT_SBmcjH1TfE3k_kHJ5Sd7nmnoKr81UiDPHXF42gd46qCAuAW5hpwjdKC-6-P8bji/pub?gid=0&single=true&output=csv";

const MANAGERS = ["Sabrina","Edward","Teresita"];
let VIEW="month";

/* üéâ MONTH THEMES */
const MONTH=new Date().toLocaleString("default",{month:"long"});
const THEMES={
  February:{emoji:"üíñ",mode:"hearts"},
  March:{emoji:"üçÄ",mode:"green"},
  July:{emoji:"üéÜ",mode:"fireworks"}
};

if(THEMES[MONTH]){
  document.querySelector("h1").innerText=
    `${THEMES[MONTH].emoji} Enrollment Race to 550 ${THEMES[MONTH].emoji}`;

  if(THEMES[MONTH].mode==="hearts"){
    setInterval(()=>confetti({
      particleCount:6,shapes:["heart"],
      colors:["#fb7185","#e11d48"],origin:{x:Math.random(),y:0}
    }),4000);
  }

  if(THEMES[MONTH].mode==="fireworks"){
    setInterval(()=>confetti({
      particleCount:120,spread:360,startVelocity:45,
      colors:["#dc2626","#fff","#2563eb"],
      origin:{x:Math.random(),y:Math.random()*0.4}
    }),3500);
  }
}

function setView(v,btn){
  VIEW=v;
  document.querySelectorAll(".buttons button")
    .forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
  loadData();
}

fetch(SHEET_URL).then(r=>r.text()).then(csv=>{
  const rows=csv.split("\n").slice(1).map(r=>r.split(","));
  window.DATA=rows.map(r=>({
    date:new Date(r[0]),
    name:r[2],
    week:r[3],
    count:+r[4]
  }));
  loadData();
});

function loadData(){
  const now=new Date();
  let filtered=DATA.filter(d=>{
    if(VIEW==="month") return d.date.getMonth()===now.getMonth();
    if(VIEW==="week") return d.date>=new Date(now-7*86400000);
    return true;
  });

  const totals={};
  filtered.forEach(d=>totals[d.name]=(totals[d.name]||0)+d.count);

  const sorted=Object.entries(totals).sort((a,b)=>b[1]-a[1]);

  document.getElementById("mvp").innerHTML=
    `<div class="mvp-badge">MVP</div>${sorted[0]?.[0]||""}<br>${sorted[0]?.[1]||0}`;

  document.getElementById("podium").innerHTML=
    sorted.slice(0,3).map((p,i)=>
      `<div class="podium-row">${i+1}. ${p[0]}<span>${p[1]}</span></div>`
    ).join("");

  document.getElementById("dashboard").innerHTML=
    sorted.map(p=>`
      <div class="card">
        <strong>${p[0]}</strong>
        <div class="progress"><div class="bar" style="width:${p[1]/5*100}%"></div></div>
        ${p[1]}
      </div>`).join("");

  document.getElementById("managers").innerHTML=
    sorted.filter(p=>MANAGERS.includes(p[0]))
      .map(p=>`<div class="card">${p[0]}<br>${p[1]}</div>`).join("");
}
</script>

</body>
</html>

