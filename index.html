<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üèÅ Enrollment Race to 550</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
/* ================= FINISH LINE ================= */
body::before{
  content:"";
  position:fixed;
  top:0;left:0;width:100%;height:26px;
  background:repeating-linear-gradient(90deg,#000 0 20px,#fff 20px 40px);
  z-index:999;
}

/* ================= BASE BACKGROUND ================= */
body{
  margin:0;
  padding:60px 16px 60px;
  font-family:Arial,sans-serif;
  background:repeating-linear-gradient(90deg,#86efac 0 60px,#a7f3d0 60px 120px);
  text-align:center;
}

/* ================= HOLIDAY THEMES ================= */
.us-holiday{background:repeating-linear-gradient(90deg,#ef4444,#fff,#2563eb)}
.mx-holiday{background:repeating-linear-gradient(90deg,#16a34a,#fff,#dc2626)}
.in-holiday{background:repeating-linear-gradient(90deg,#f59e0b,#fff,#16a34a)}
.ph-holiday{background:repeating-linear-gradient(90deg,#1d4ed8,#fff,#dc2626)}

h1{color:#ef4444;margin-bottom:16px}

.buttons button{
  padding:10px 16px;
  margin:6px;
  border-radius:14px;
  border:none;
  font-weight:bold;
  cursor:pointer;
}

/* ================= CARDS ================= */
.card{
  background:#fff;
  max-width:380px;
  margin:18px auto;
  padding:20px;
  border-radius:26px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  position:relative;
}

/* ================= PROGRESS ================= */
.progress{
  background:#e5e7eb;
  height:20px;
  border-radius:14px;
  overflow:hidden;
  margin:12px 0;
}
.bar{
  height:100%;
  transition:.6s;
  position:relative;
}
.bar::after{
  content:"üèéÔ∏èüí®";
  position:absolute;
  right:-8px;
  top:-18px;
}

/* ================= MVP & PODIUM ================= */
#mvp,#podium{
  position:fixed;
  top:120px;
  width:380px;
  padding:20px;
  border-radius:26px;
  background:#fff;
  box-shadow:0 14px 30px rgba(0,0,0,.2);
}
#mvp{
  left:16px;
  border:4px solid #f59e0b;
  background:#fff7ed;
  animation:pulse 2s infinite;
}
#podium{
  right:16px;
  border:4px solid #2563eb;
  animation:bounce 2s infinite;
}
@keyframes pulse{50%{transform:scale(1.05)}}
@keyframes bounce{50%{transform:translateY(-6px)}}

.podium-row{
  display:flex;
  justify-content:space-between;
  font-weight:bold;
}

/* ================= MANAGERS ================= */
#managers h2{color:#1d4ed8;margin-top:28px}

/* ================= LAP ================= */
#lapCounter{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#fff;
  padding:10px 18px;
  border-radius:18px;
  font-weight:bold;
}

/* ================= SPONSOR ================= */
#sponsor{
  position:fixed;
  bottom:16px;
  left:16px;
}
#sponsor img{width:120px}
</style>
</head>

<body>

<h1>üèÅ Enrollment Race to 550</h1>

<div class="buttons">
  <button onclick="setView('ytd')">YTD</button>
  <button onclick="setView('month')">Month</button>
  <button onclick="setView('week')">Week</button>
</div>

<div id="mvp"></div>
<div id="podium"></div>
<div id="team"></div>
<div id="dashboard"></div>
<div id="managers"></div>
<div id="lapCounter"></div>

<div id="sponsor">
  <img src="WEB-HAMPTON-INN-AND-SUITES.jpg" alt="Hampton Inn & Suites">
</div>

<script>
const TEAM_GOAL=550;
const MANAGER_START="Sabrina";

const YEARLY="https://docs.google.com/spreadsheets/d/e/2PACX-1vTDtYk0GQ5RzrRT_SBmcjH1TfE3k_kHJ5Sd7nmnoKr81UiDPHXF42gd46qCAuAW5hpwjdKC-6-P8bji/pub?gid=1984389436&single=true&output=csv";
const WEEKLY="https://docs.google.com/spreadsheets/d/e/2PACX-1vTDtYk0GQ5RzrRT_SBmcjH1TfE3k_kHJ5Sd7nmnoKr81UiDPHXF42gd46qCAuAW5hpwjdKC-6-P8bji/pub?gid=0&single=true&output=csv";

const COLORS={
  Sabrina:"#22c55e",
  Teresita:"#93c5fd",
  Edward:"#ffffff"
};

let view="month";

(function(){
  const d=new Date(),m=d.getMonth()+1,day=d.getDate();
  if(m===7&&day===4)document.body.classList.add("us-holiday");
  if(m===5&&day===5||m===9&&day===16)document.body.classList.add("mx-holiday");
  if(m===8&&day===15)document.body.classList.add("in-holiday");
  if(m===6&&day===12||m===8&&day===21)document.body.classList.add("ph-holiday");
})();

function setView(v){view=v;load();}

function load(){
Promise.all([fetch(YEARLY).then(r=>r.text()),fetch(WEEKLY).then(r=>r.text())])
.then(([y,w])=>{
const weekly=w.split("\n").slice(1).map(r=>{
const c=r.split(",");return{d:new Date(c[0]),n:c[1],v:+c[2]||0};
});
const people=y.split("\n").slice(1).map(r=>{
const c=r.split(",");return{name:c[0],goal:+c[1],ytd:+c[2],total:0};
});
const now=new Date();
people.forEach(p=>{
if(view==="ytd"){p.total=p.ytd;return;}
weekly.forEach(r=>{
if(r.n!==p.name)return;
const diff=(now-r.d)/86400000;
if(view==="week"&&diff<=7)p.total+=r.v;
if(view==="month"&&r.d.getMonth()===now.getMonth())p.total+=r.v;
});
});
render(people);
});
}

function render(p){
const dash=document.getElementById("dashboard");
const mgr=document.getElementById("managers");
dash.innerHTML="";mgr.innerHTML="";

const teamTotal=p.reduce((a,b)=>a+b.total,0);
document.getElementById("team").innerHTML=`
<div class="card"><h2>üèÅ Team Goal</h2>
<div class="progress"><div class="bar" style="width:${teamTotal/TEAM_GOAL*100}%"></div></div>
${teamTotal} / ${TEAM_GOAL}</div>`;

p.sort((a,b)=>b.total-a.total);

document.getElementById("mvp").innerHTML=p[0]?.total?
`üèÜ MVP<br><strong>${p[0].name}</strong><br>${p[0].total}`:"üèÜ MVP<br>Waiting‚Ä¶";

document.getElementById("podium").innerHTML=
`<h3>üèÅ Podium</h3>`+p.slice(0,3).map((x,i)=>
`<div class="podium-row">${["ü•á","ü•à","ü•â"][i]} ${x.name}<span>${x.total}</span></div>`).join("");

const idx=p.findIndex(x=>x.name===MANAGER_START);
const staff=idx<0?p:p.slice(0,idx);
const managers=idx<0?[]:p.slice(idx);

staff.forEach(x=>{
const pc=x.total/x.goal*100;
dash.innerHTML+=`
<div class="card"><h2>${x.name}</h2>
<div class="progress"><div class="bar" style="width:${pc}%;background:${COLORS[x.name]||'#22c55e'}"></div></div>
${x.total}/${x.goal}</div>`;
});

if(managers.length)mgr.innerHTML="<h2>‚≠ê Managers</h2>";
managers.forEach(x=>{
const pc=x.total/x.goal*100;
mgr.innerHTML+=`
<div class="card"><h2>${x.name}</h2>
<div class="progress"><div class="bar" style="width:${pc}%;background:${COLORS[x.name]||'#2563eb'}"></div></div>
${x.total}/${x.goal}</div>`;
});

document.getElementById("lapCounter").innerText=
teamTotal>=TEAM_GOAL?"üèÅ Finished":"Lap "+Math.ceil(teamTotal/TEAM_GOAL*4);
}

load();
</script>
</body>
</html>
